<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Everton Hub | Official</title>
    <style>
        :root {
            --efc-blue: #003399;
            --efc-dark: #050a14;
            --pitch-green: #2d5a27;
            --slime-red: #d40000;
            --gold: #ffd700;
        }

        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--efc-dark); color: white; overflow-x: hidden; }

        /* Navigation */
        .header { background: var(--efc-blue); padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 3px solid var(--gold); position: sticky; top: 0; z-index: 1000; }
        .menu-icon { font-size: 30px; cursor: pointer; background: none; border: none; color: white; }
        
        .side-menu {
            height: 100%; width: 0; position: fixed; z-index: 2000; top: 0; left: 0;
            background-color: #001233; overflow-x: hidden; transition: 0.4s;
            padding-top: 60px; box-shadow: 5px 0 15px rgba(0,0,0,0.5);
        }
        .side-menu a { padding: 15px 25px; text-decoration: none; font-size: 18px; color: white; display: block; border-bottom: 1px solid rgba(255,255,255,0.1); cursor: pointer; }

        /* UI Containers */
        .page-section { display: none; padding: 20px; text-align: center; min-height: 80vh; }
        .active { display: block; }
        .data-card { background: white; color: #333; border-radius: 12px; padding: 15px; max-width: 800px; margin: auto; box-shadow: 0 4px 20px rgba(0,0,0,0.4); }

        /* Pitch & Formation */
        .pitch { 
            background: var(--pitch-green); width: 95%; max-width: 450px; height: 420px; 
            margin: 20px auto; border-radius: 10px; position: relative; border: 2px solid white;
            background-image: linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 100% 40px;
        }
        .player { 
            width: 44px; height: 44px; background: var(--efc-blue); border: 2px solid var(--gold); 
            border-radius: 50%; position: absolute; display: flex; align-items: center; 
            justify-content: center; font-size: 8px; font-weight: bold; transform: translate(-50%, -50%); cursor: pointer;
        }

        /* League Table */
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { background: var(--efc-blue); color: white; padding: 10px; }
        td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; }
        .efc-row { background: #eef4ff !important; font-weight: bold; color: var(--efc-blue); }
        .editable:hover { background: #ffffd0; cursor: cell; }

        /* Admin Controls */
        .admin-toolbar { background: #222; border: 2px dashed red; padding: 15px; margin: 15px auto; max-width: 600px; border-radius: 10px; display: none; color: white; }
        .slime-btn { background: var(--slime-red); color: white; border: none; padding: 12px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 0px #8b0000; margin: 5px; }

        #resultGui { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; color: black; padding: 30px; border-radius: 15px; border: 5px solid var(--efc-blue); z-index: 5000; display: none; text-align: center; }
    </style>
</head>
<body>

    <div class="header">
        <button class="menu-icon" onclick="toggleNav(true)">☰</button>
        <span id="pageTitle">EVERTON HUB</span>
        <div id="admBadge" style="display:none; color:red; font-weight:bold; font-size:12px;">ADMIN ACTIVE</div>
    </div>

    <div id="mySidenav" class="side-menu">
        <a onclick="toggleNav(false)">× Close</a>
        <a onclick="showPage('home', 'EVERTON HUB')">Home (Pitch)</a>
        <a onclick="showPage('leagues', 'PREMIER LEAGUE')">Leagues</a>
        <a onclick="showPage('logs', 'MATCH LOGS')">Match Logs</a>
        <a onclick="showPage('scorer', 'GOLDEN BOOT')">Golden Boot</a>
        <a onclick="showPage('hub', 'MATCH HUB')">Prediction Hub</a>
        <a id="premiumLink" style="display:none; background:var(--gold); color:black; font-weight:bold;" onclick="showPage('premium', 'PREMIUM ZONE')">★ PREMIUM ZONE</a>
    </div>

    <div id="home" class="page-section active">
        <div class="pitch">
            <div class="player" style="bottom: 5%; left: 50%;" ondblclick="editThis(this)">GK</div>
            <div class="player" style="bottom: 25%; left: 15%;" ondblclick="editThis(this)">LB</div>
            <div class="player" style="bottom: 20%; left: 38%;" ondblclick="editThis(this)">CB</div>
            <div class="player" style="bottom: 20%; left: 62%;" ondblclick="editThis(this)">CB</div>
            <div class="player" style="bottom: 25%; left: 85%;" ondblclick="editThis(this)">RB</div>
            <div class="player" style="bottom: 50%; left: 25%;" ondblclick="editThis(this)">CM</div>
            <div class="player" style="bottom: 45%; left: 50%;" ondblclick="editThis(this)">CDM</div>
            <div class="player" style="bottom: 50%; left: 75%;" ondblclick="editThis(this)">CM</div>
            <div class="player" style="top: 15%; left: 20%;" ondblclick="editThis(this)">LW</div>
            <div class="player" style="top: 10%; left: 50%;" ondblclick="editThis(this)">ST</div>
            <div class="player" style="top: 15%; left: 80%;" ondblclick="editThis(this)">RW</div>
        </div>
        
    </div>

    <div id="leagues" class="page-section">
        <div class="data-card">
            <table>
                <thead><tr><th>#</th><th style="text-align:left">Team</th><th>P</th><th>GD</th><th>GS</th><th>Pts</th></tr></thead>
                <tbody id="leagueBody"></tbody>
            </table>
        </div>
        
    </div>

    <div id="logs" class="page-section">
        <div class="data-card">
            <h3>Match History</h3>
            <p>No matches recorded yet.</p>
            <table id="logTable" style="display:none;">
                <thead><tr><th>Fixture</th><th>Result</th><th>Status</th></tr></thead>
                <tbody id="logBody"></tbody>
            </table>
        </div>
    </div>

    <div id="scorer" class="page-section">
        <div class="data-card">
            <h3>Top Scorers</h3>
            <ul id="scorerList" style="text-align:left; list-style:none; padding:0;">
                <li ondblclick="editThis(this)">1. Calvert-Lewin - 0 Goals</li>
            </ul>
        </div>
    </div>

    <div id="hub" class="page-section">
        <div id="adminControls" class="admin-toolbar">
            <h4>Admin Control Panel</h4>
            Category: <input type="text" id="admCat" placeholder="e.g. Premier League">
            <br><br>
            Score: <input type="number" id="admH" style="width:40px"> : <input type="number" id="admA" style="width:40px">
            <br>
            <button class="slime-btn" onclick="lockOfficial()">1. Lock Result</button>
            <button class="slime-btn" onclick="spawnResultGui()">2. Spawn Result GUI</button>
        </div>

        <div class="data-card">
            <div id="activeCategory" style="background:var(--gold); color:black; padding:3px 10px; border-radius:10px; font-size:11px; font-weight:bold; margin-bottom:10px;">UPCOMING MATCH</div>
            <h3>Predict Score</h3>
            <div id="predInputArea">
                <input type="number" id="uH" style="width:50px"> : <input type="number" id="uA" style="width:50px">
                <br><br><button class="slime-btn" onclick="userSubmit()">Submit Prediction</button>
            </div>
            <div id="predLockedArea" style="display:none;">
                <h4 id="myGuess"></h4>
                <p style="color:red; font-weight:bold;">SCORE SUBMITTED</p>
            </div>
        </div>
    </div>

    <div id="premium" class="page-section">
        <div class="data-card" style="background:#111; color:white;">
            <h3 style="color:var(--gold);">Supporter Chat</h3>
            <div id="chatBox" style="height:150px; overflow-y:auto; background:black; color:lime; font-family:monospace; padding:10px; text-align:left;">Welcome...</div>
            <input type="text" id="chatIn" style="width:70%; padding:10px; margin-top:10px;">
            <button class="slime-btn" onclick="sendChat()">Send</button>
        </div>
    </div>

    <div id="resultGui">
        <h1 id="guiFinalScore">0 - 0</h1>
        <h3 id="guiStatusText">Checking result...</h3>
        <button class="slime-btn" onclick="document.getElementById('resultGui').style.display='none'">Close</button>
    </div>

    <div id="portal" onclick="adminLogin()" style="position:fixed; bottom:0; right:0; width:30px; height:30px; opacity:0; cursor:pointer;"></div>

    <script>
        let isAdmin = false;
        let teams = [
            "Arsenal", "Aston Villa", "Bournemouth", "Brentford", "Brighton", 
            "Burnley", "Chelsea", "Crystal Palace", "Everton", "Fulham", 
            "Leeds United", "Liverpool", "Man City", "Man United", "Newcastle", 
            "Nottm Forest", "Sunderland", "Tottenham", "West Ham", "Wolves"
        ].map(name => ({name, p: 0, gd: 0, gs: 0, pts: 0}));

        function toggleNav(o) { document.getElementById("mySidenav").style.width = o ? "260px" : "0"; }
        
        function showPage(id, title) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('pageTitle').innerText = title;
            toggleNav(false);
        }

        function renderLeague() {
            // Sort: Points > GD > GS
            teams.sort((a,b) => b.pts - a.pts || b.gd - a.gd || b.gs - a.gs);
            const body = document.getElementById('leagueBody');
            body.innerHTML = "";
            teams.forEach((t, i) => {
                const row = document.createElement('tr');
                if(t.name === "Everton") row.className = "efc-row";
                row.innerHTML = `<td>${i+1}</td><td style="text-align:left" ondblclick="editTeam(${i},'name')">${t.name}</td>
                <td ondblclick="editTeam(${i},'p')">${t.p}</td><td ondblclick="editTeam(${i},'gd')">${t.gd}</td>
                <td ondblclick="editTeam(${i},'gs')">${t.gs}</td><td ondblclick="editTeam(${i},'pts')">${t.pts}</td>`;
                body.appendChild(row);
            });
        }

        function editTeam(idx, field) {
            if(!isAdmin) return;
            let val = prompt("Update " + field, teams[idx][field]);
            if(val !== null) {
                teams[idx][field] = isNaN(val) ? val : parseInt(val);
                renderLeague();
            }
        }

        function editThis(el) {
            if(!isAdmin) return;
            let val = prompt("Edit text:", el.innerText);
            if(val) el.innerText = val;
        }

        function adminLogin() {
            if(prompt("Passcode:") === "efc26") {
                isAdmin = true;
                document.getElementById('adminControls').style.display = 'block';
                document.getElementById('admBadge').style.display = 'block';
                unlockPremium();
                renderLeague();
            }
        }

        function lockOfficial() {
            const s = document.getElementById('admH').value + "-" + document.getElementById('admA').value;
            const cat = document.getElementById('admCat').value || "MATCH PREDICTION";
            localStorage.setItem('officialScore', s);
            localStorage.setItem('officialCat', cat);
            document.getElementById('activeCategory').innerText = cat.toUpperCase();
            alert("Score Locked!");
        }

        function spawnResultGui() {
            const official = localStorage.getItem('officialScore') || "0-0";
            const mine = localStorage.getItem('userPred');
            document.getElementById('resultGui').style.display = 'block';
            document.getElementById('guiFinalScore').innerText = "RESULT: " + official;
            if(mine === official) {
                document.getElementById('guiStatusText').innerText = "CORRECT! PREMIUM UNLOCKED";
                unlockPremium();
            } else {
                document.getElementById('guiStatusText').innerText = "WRONG SCORE. TRY AGAIN NEXT TIME!";
            }
        }

        function userSubmit() {
            const s = document.getElementById('uH').value + "-" + document.getElementById('uA').value;
            localStorage.setItem('userPred', s);
            location.reload();
        }

        function unlockPremium() {
            document.getElementById('premiumLink').style.display = 'block';
            localStorage.setItem('isPrem', 'true');
        }

        function sendChat() {
            const box = document.getElementById('chatBox');
            const msg = document.getElementById('chatIn').value;
            if(msg) {
                box.innerHTML += `<br><b>Supporter:</b> ${msg}`;
                document.getElementById('chatIn').value = "";
            }
        }

        // Check save states
        if(localStorage.getItem('userPred')) {
            document.getElementById('predInputArea').style.display = 'none';
            document.getElementById('predLockedArea').style.display = 'block';
            document.getElementById('myGuess').innerText = "Your Prediction: " + localStorage.getItem('userPred');
        }
        if(localStorage.getItem('officialCat')) document.getElementById('activeCategory').innerText = localStorage.getItem('officialCat').toUpperCase();
        if(localStorage.getItem('isPrem')) unlockPremium();
        renderLeague();
    </script>
</body>
</html>
