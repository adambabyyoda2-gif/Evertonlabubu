<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EFC Hub | Admin Pro</title>
    <style>
        :root { --efc: #003399; --dark: #050a14; --gold: #ffd700; --slime: #d40000; }
        body { font-family: sans-serif; background: var(--dark); color: white; margin: 0; }
        .header { background: var(--efc); padding: 15px; border-bottom: 3px solid var(--gold); display: flex; justify-content: space-between; align-items: center; }
        .page-section { display: none; padding: 20px; text-align: center; }
        .active { display: block; }
        
        /* Table Styling */
        .data-card { background: white; color: #333; border-radius: 10px; padding: 15px; max-width: 800px; margin: auto; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        th { background: var(--efc); color: white; padding: 10px; }
        td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; }
        .efc-row { background: #eef4ff !important; font-weight: bold; }
        .editable:hover { background: #ffffd0; cursor: pointer; }

        /* Admin Controls */
        .admin-bar { background: #222; padding: 15px; border: 2px dashed red; margin-bottom: 20px; border-radius: 8px; display: none; }
        .slime-btn { background: var(--slime); color: white; border: none; padding: 10px 20px; border-radius: 20px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 0 #8b0000; margin: 5px; }
        input[type="text"], input[type="number"] { padding: 8px; border-radius: 4px; border: 1px solid #ccc; }

        /* Prediction Badge */
        .category-badge { background: var(--gold); color: black; padding: 4px 10px; border-radius: 12px; font-size: 11px; font-weight: bold; margin-bottom: 10px; display: inline-block; }
    </style>
</head>
<body>

<div class="header">
    <button onclick="toggleMenu()" style="background:none; border:none; color:white; font-size:24px; cursor:pointer;">â˜°</button>
    <span id="pageTitle">EVERTON HUB</span>
    <div id="admBadge" style="color:red; font-size:10px; display:none; border: 1px solid red; padding: 2px 5px;">ADMIN MODE</div>
</div>

<div id="sideMenu" style="display:none; position:fixed; width:220px; height:100%; background:#001233; z-index:1000; padding:20px; box-shadow: 5px 0 15px rgba(0,0,0,0.5);">
    <a href="#" onclick="showPage('home','EVERTON HUB')" style="color:white; display:block; padding:12px; text-decoration:none; border-bottom:1px solid #1a2a44;">Home (Pitch)</a>
    <a href="#" onclick="showPage('leagues','PREMIER LEAGUE')" style="color:white; display:block; padding:12px; text-decoration:none; border-bottom:1px solid #1a2a44;">Leagues</a>
    <a href="#" onclick="showPage('logs','MATCH LOGS')" style="color:white; display:block; padding:12px; text-decoration:none; border-bottom:1px solid #1a2a44;">Match Logs</a>
    <a href="#" onclick="showPage('hub','MATCH HUB')" style="color:white; display:block; padding:12px; text-decoration:none; border-bottom:1px solid #1a2a44;">Prediction Hub</a>
</div>

<div id="leagues" class="page-section">
    <div class="data-card">
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th style="text-align:left">Team</th>
                    <th>P</th>
                    <th>GD</th>
                    <th>GS</th>
                    <th>Pts</th>
                </tr>
            </thead>
            <tbody id="leagueBody"></tbody>
        </table>
    </div>
</div>

<div id="logs" class="page-section">
    <div class="data-card">
        <h3>Match History</h3>
        <table>
            <thead><tr><th>Fixture</th><th>Result</th><th>Status</th></tr></thead>
            <tbody id="logBody">
                <tr><td>EFC vs Liverpool</td><td>2 - 0</td><td><span style="color:green">Win</span></td></tr>
                <tr><td>Brentford vs EFC</td><td>1 - 1</td><td><span style="color:orange">Draw</span></td></tr>
            </tbody>
        </table>
    </div>
</div>

<div id="hub" class="page-section active">
    <div id="adminControls" class="admin-bar">
        <h4>Admin Match Controller</h4>
        <div style="margin-bottom:10px;">
            Category: <input type="text" id="admCat" placeholder="e.g. Premier League" style="width:150px">
        </div>
        <input type="number" id="admH" placeholder="EFC" style="width:50px"> : <input type="number" id="admA" placeholder="OPP" style="width:50px">
        <br>
        <button class="slime-btn" onclick="showPage('home','EVERTON HUB')">1. Change Teams</button>
        <button class="slime-btn" onclick="lockScore()">2. Lock Result</button>
        <button class="slime-btn" onclick="spawnGui()">3. Spawn Result GUI</button>
    </div>

    <div class="data-card">
        <div id="predCategoryDisplay" class="category-badge">UPCOMING MATCH</div>
        <h3>Predict the Score</h3>
        <div id="predictionUI">
            <input type="number" id="uH" style="width:50px" placeholder="EFC"> : <input type="number" id="uA" style="width:50px" placeholder="OPP">
            <br><br>
            <button class="slime-btn" onclick="submitUserScore()">Submit Prediction</button>
        </div>
        <div id="predLockedUI" style="display:none;">
            <h4 id="userGuessDisplay" style="color:var(--efc)"></h4>
            <p style="color:red; font-weight:bold;">SCORE LOCKED</p>
        </div>
    </div>
</div>

<div id="secret" onclick="adminLogin()" style="position:fixed; bottom:0; right:0; width:30px; height:30px; opacity:0; cursor:pointer;"></div>

<script>
    let isAdmin = false;
    let leagueData = [
        {name: "Arsenal", p: 24, gd: 31, gs: 55, pts: 52},
        {name: "Man City", p: 24, gd: 29, gs: 56, pts: 52},
        {name: "Everton", p: 24, gd: 5, gs: 30, pts: 35},
        {name: "Liverpool", p: 24, gd: 25, gs: 50, pts: 51}
    ];

    function toggleMenu() {
        const m = document.getElementById('sideMenu');
        m.style.display = m.style.display === 'none' ? 'block' : 'none';
    }

    function showPage(id, title) {
        document.querySelectorAll('.page-section').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.getElementById('pageTitle').innerText = title;
        document.getElementById('sideMenu').style.display = 'none';
    }

    function renderTable() {
        // Multi-criteria sort: Pts -> GD -> GS
        leagueData.sort((a, b) => b.pts - a.pts || b.gd - a.gd || b.gs - a.gs);
        
        const body = document.getElementById('leagueBody');
        body.innerHTML = "";
        leagueData.forEach((t, i) => {
            const row = document.createElement('tr');
            if(t.name === "Everton") row.className = "efc-row";
            row.innerHTML = `
                <td>${i+1}</td>
                <td style="text-align:left" class="editable" ondblclick="editCell(${i}, 'name')">${t.name}</td>
                <td class="editable" ondblclick="editCell(${i}, 'p')">${t.p}</td>
                <td class="editable" ondblclick="editCell(${i}, 'gd')">${t.gd}</td>
                <td class="editable" ondblclick="editCell(${i}, 'gs')">${t.gs}</td>
                <td class="editable" ondblclick="editCell(${i}, 'pts')">${t.pts}</td>
            `;
            body.appendChild(row);
        });
    }

    function editCell(index, field) {
        if(!isAdmin) return;
        const newVal = prompt(`Update ${field}:`, leagueData[index][field]);
        if(newVal !== null) {
            leagueData[index][field] = isNaN(newVal) ? newVal : parseInt(newVal);
            renderTable();
        }
    }

    function adminLogin() {
        if(prompt("Passcode:") === "efc26") {
            isAdmin = true;
            document.getElementById('adminControls').style.display = 'block';
            document.getElementById('admBadge').style.display = 'block';
            alert("Admin Active! You can now edit the table and set prediction categories.");
            renderTable();
        }
    }

    function lockScore() {
        const score = document.getElementById('admH').value + "-" + document.getElementById('admA').value;
        const category = document.getElementById('admCat').value || "MATCH PREDICTION";
        localStorage.setItem('officialScore', score);
        localStorage.setItem('officialCategory', category);
        
        // Update display
        document.getElementById('predCategoryDisplay').innerText = category.toUpperCase();
        alert(`Locked: ${score} (${category})`);
    }

    function submitUserScore() {
        const s = document.getElementById('uH').value + "-" + document.getElementById('uA').value;
        localStorage.setItem('userPred', s);
        document.getElementById('predictionUI').style.display = 'none';
        document.getElementById('predLockedUI').style.display = 'block';
        document.getElementById('userGuessDisplay').innerText = "Your Guess: " + s;
    }

    // Load saved prediction state
    if(localStorage.getItem('userPred')) {
        document.getElementById('predictionUI').style.display = 'none';
        document.getElementById('predLockedUI').style.display = 'block';
        document.getElementById('userGuessDisplay').innerText = "Your Guess: " + localStorage.getItem('userPred');
    }
    if(localStorage.getItem('officialCategory')) {
        document.getElementById('predCategoryDisplay').innerText = localStorage.getItem('officialCategory').toUpperCase();
    }

    renderTable();
</script>
</body>
</html>
